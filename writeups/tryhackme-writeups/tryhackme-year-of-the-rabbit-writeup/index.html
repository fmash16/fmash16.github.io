<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
        TryHackMe - Year of the Rabbit - Writeup - fmash16&#39;s blog
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="topics: sudo CVE-2019-14287 privesc, ftp, hydra, brainfuck, stego, pt_chown" />
    <meta name="generator" content="Hugo 0.71.0 with theme pure" />
    <title>TryHackMe - Year of the Rabbit - Writeup - fmash16&#39;s blog</title>
    
    
    <link rel="stylesheet" href="https://fmash16.github.io/css/style.min.31eb31d4d371f959a57f97c6d09f5d586c90080c4a472ef26da78a70891385e0.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:title" content="TryHackMe - Year of the Rabbit - Writeup" />
<meta property="og:description" content="topics: sudo CVE-2019-14287 privesc, ftp, hydra, brainfuck, stego, pt_chown" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-year-of-the-rabbit-writeup/" />
<meta property="og:image" content="https://fmash16.github.io/shortcode" />
<meta property="og:image" content="https://fmash16.github.io/" />
<meta property="article:published_time" content="2020-05-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-21T00:00:00+00:00" />

<meta itemprop="name" content="TryHackMe - Year of the Rabbit - Writeup">
<meta itemprop="description" content="topics: sudo CVE-2019-14287 privesc, ftp, hydra, brainfuck, stego, pt_chown">
<meta itemprop="datePublished" content="2020-05-21T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-21T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="675">
<meta itemprop="image" content="https://fmash16.github.io/shortcode">
<meta itemprop="image" content="https://fmash16.github.io/">



<meta itemprop="keywords" content="sudo,CVE-2019-14287,privesc,ftp,hydra,brainfuck,stego,pt_chown," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://fmash16.github.io/shortcode"/>

<meta name="twitter:title" content="TryHackMe - Year of the Rabbit - Writeup"/>
<meta name="twitter:description" content="topics: sudo CVE-2019-14287 privesc, ftp, hydra, brainfuck, stego, pt_chown"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->

   
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto&#43;Sans&#43;JP&amp;display=swap" type="text/css" media="all" /> 
   

  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="/">
            <img class="img-circle img-rotate" src="https://fmash16.github.io/avatar.png" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">fmash16</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">Student</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Dhaka, Bangladesh</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>

        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Posts</span>
                </a>
            </li>
            <li class="menu-item menu-item-books">
                <a href="/categories/">
                    <i class="icon icon-book-fill"></i>
                  <span class="menu-title">Writeups</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <div class="widget">
  <h3 class="widget-title"><u> Categories</u></h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://fmash16.github.io/categories/hackthebox-writeups/" class="category-list-link">hackthebox-writeups</a><span class="category-list-count">7</span></li>
            <li class="category-list-item"><a href="https://fmash16.github.io/categories/tryhackme-writeups/" class="category-list-link">tryhackme-writeups</a><span class="category-list-count">4</span></li>
        </ul>
    </div>
</div>
<div class="widget">
  <h3 class="widget-title"><u> Tags </u></h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <a href="https://fmash16.github.io/tags/ad/" class="tag-list-link">ad</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/adminer/" class="tag-list-link">adminer</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/azure/" class="tag-list-link">azure</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/azure-ad-connect/" class="tag-list-link">azure-ad-connect</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/bludit-cms/" class="tag-list-link">bludit-cms</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/brainfuck/" class="tag-list-link">brainfuck</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cewl/" class="tag-list-link">cewl</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/command-injection/" class="tag-list-link">command-injection</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/crackmapexec/" class="tag-list-link">crackmapexec</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cron/" class="tag-list-link">cron</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/crontab/" class="tag-list-link">crontab</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cve-2019-14287/" class="tag-list-link">cve-2019-14287</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dll/" class="tag-list-link">dll</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dns/" class="tag-list-link">dns</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dnsadmins/" class="tag-list-link">dnsadmins</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/docker/" class="tag-list-link">docker</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/dynamic-js/" class="tag-list-link">dynamic-js</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dynamic-xss/" class="tag-list-link">dynamic-xss</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/easy/" class="tag-list-link">easy</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/evil-winrm/" class="tag-list-link">evil-winrm</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/file-descriptor/" class="tag-list-link">file-descriptor</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/ftp/" class="tag-list-link">ftp</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/fuzzing/" class="tag-list-link">fuzzing</a><span class="tag-list-count">4</span>
            
            
            <a href="https://fmash16.github.io/tags/gila-cms/" class="tag-list-link">gila-cms</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/gtfobins/" class="tag-list-link">gtfobins</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/hacking/" class="tag-list-link">hacking</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/hydra/" class="tag-list-link">hydra</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/injection/" class="tag-list-link">injection</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/john/" class="tag-list-link">john</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/kvm/" class="tag-list-link">kvm</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/ldap/" class="tag-list-link">ldap</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/ldapsearch/" class="tag-list-link">ldapsearch</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/lfi/" class="tag-list-link">lfi</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/linux/" class="tag-list-link">linux</a><span class="tag-list-count">3</span>
            
            
            <a href="https://fmash16.github.io/tags/logrotate-race-condition/" class="tag-list-link">logrotate-race-condition</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/mysql/" class="tag-list-link">mysql</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/mysqldump/" class="tag-list-link">mysqldump</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/passthrough/" class="tag-list-link">passthrough</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/php/" class="tag-list-link">php</a><span class="tag-list-count">4</span>
            
            
            <a href="https://fmash16.github.io/tags/powershell/" class="tag-list-link">powershell</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/practice/" class="tag-list-link">practice</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/privesc/" class="tag-list-link">privesc</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/pt_chown/" class="tag-list-link">pt_chown</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/pwn/" class="tag-list-link">pwn</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/python/" class="tag-list-link">python</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/python-path-hijack/" class="tag-list-link">python-path-hijack</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/qemu/" class="tag-list-link">qemu</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/rce/" class="tag-list-link">rce</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/real-world/" class="tag-list-link">real-world</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/rpcclient/" class="tag-list-link">rpcclient</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sql/" class="tag-list-link">sql</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sql-truncation-attack/" class="tag-list-link">sql-truncation-attack</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/stego/" class="tag-list-link">stego</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/subdomain/" class="tag-list-link">subdomain</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sudo/" class="tag-list-link">sudo</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/sudo-privesc/" class="tag-list-link">sudo-privesc</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/tar/" class="tag-list-link">tar</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/virtualization/" class="tag-list-link">virtualization</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/web/" class="tag-list-link">web</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/wfuzz/" class="tag-list-link">wfuzz</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/wildcard/" class="tag-list-link">wildcard</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/xss/" class="tag-list-link">xss</a><span class="tag-list-count">1</span>
            
        </ul>

    </div>
</div>

<div class="widget">
  <h3 class="widget-title"><u> Recent Posts </u></h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-resolute-writeup/" class="title">Hackthebox - Resolute Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-28 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-05-28</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-book-writeup/" class="title">Hackthebox - Book Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-04 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-04</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-cmess-writeup/" class="title">TryHackMe - CMesS Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-03 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-03</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-blunder-writeup/" class="title">Hackthebox - Blunder Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-31 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-05-31</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-montevarde-writeup/" class="title">Hackthebox - Montevarde Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-30 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-05-30</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>

  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Table of Contents</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>

<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h3 itemprop="name">
  <a
    class="article-title"
    href="/writeups/tryhackme-writeups/tryhackme-year-of-the-rabbit-writeup/"
    >TryHackMe - Year of the Rabbit - Writeup</a
  >
</h3>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-year-of-the-rabbit-writeup/" class="article-date">
  <time datetime="2020-05-21 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-05-21</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/tryhackme-writeups/"> TryHackMe writeups </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/sudo/"> sudo </a>
    <a class="article-tag-link" href="/tags/cve-2019-14287/"> CVE-2019-14287 </a>
    <a class="article-tag-link" href="/tags/privesc/"> privesc </a>
    <a class="article-tag-link" href="/tags/ftp/"> ftp </a>
    <a class="article-tag-link" href="/tags/hydra/"> hydra </a>
    <a class="article-tag-link" href="/tags/brainfuck/"> brainfuck </a>
    <a class="article-tag-link" href="/tags/stego/"> stego </a>
    <a class="article-tag-link" href="/tags/pt_chown/"> pt_chown </a>
  </span>
<br>
        
        
        
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <h2 id="initial-foothold">Initial Foothold</h2>
<h3 id="nmap-scan">Nmap scan</h3>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>nmap -sC -sV -sS -oN nmap.out 10.10.104.143
</code></pre></div><p>Open ports:</p>
<blockquote>
<p>21 - vsftpd 3.0.2
22 - ssh
80 - httpd</p>
</blockquote>
<h3 id="port-80">Port 80</h3>
<p>We got a default apache2 webpage at port 80</p>
<p>Fuzzing the url with gobuster shows a folder /assets</p>
<p><img src="/img/tryhackme_yearoftherabbit/1.png" alt=""></p>
<p><img src="/img/tryhackme_yearoftherabbit/2.png" alt=""></p>
<p>We have a look at the css file and fine something interesting</p>
<p><img src="/img/tryhackme_yearoftherabbit/3.png" alt=""></p>
<p>We find a php file at /10.10.57.192/sup3r_s3cr3t_fl4g.php
Going to the page pops up an alert to turn of javascript and redirects to
a youtube page for the song found in RickRolled.mp4</p>
<p><img src="/img/tryhackme_yearoftherabbit/4.png" alt=""></p>
<p>It says that the hint is in the video.</p>
<p>We intercept the request to this url using burpsuite and look at the http
response.</p>
<p><img src="/img/tryhackme_yearoftherabbit/5.png" alt=""></p>
<p>We find a hidden directory here. Going to the hidden directory, we get the following page:</p>
<p><img src="/img/tryhackme_yearoftherabbit/6.png" alt=""></p>
<p>We got a hot=babe.png picture:</p>
<p><img src="/img/tryhackme_yearoftherabbit/7.png" alt=""></p>
<h3 id="steg-image">Steg image</h3>
<p>We download the picture to our local machine and take a look at it using
exiftool</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>exiftool Hot_Babe.png
</code></pre></div><p><img src="/img/tryhackme_yearoftherabbit/8.png" alt=""></p>
<p>It shows us that the picture has some trailing data after PNG IEND chunk. We
have a look at the data using</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>strings Hot_Babe.png
</code></pre></div><p><img src="/img/tryhackme_yearoftherabbit/9.png" alt=""></p>
<p>So the ftp username is &ldquo;ftpuser&rdquo;</p>
<h3 id="ftp-login-bruteforce-with-hydra">ftp login bruteforce with hydra</h3>
<p>And we get a list of possible passwords. So we can bruteforce the password
using hydra.</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>hydra -l ftpuser -P wordlist.txt ftp://<span style="color:#40ffff">$ip</span>
</code></pre></div><p>And we get a hit.
<img src="/img/tryhackme_yearoftherabbit/10.png" alt=""></p>
<p>Creds found:</p>
<blockquote>
<p>ftpuser : 5iez1wGXKfPKQ</p>
</blockquote>
<p>We login to the ftp using the obtained creds.</p>
<p><img src="/img/tryhackme_yearoftherabbit/11.png" alt=""></p>
<h2 id="privilege-escalation--user-eli">Privilege Escalation : User-eli</h2>
<hr>
<h3 id="brainfuck-programming-language">Brainfuck programming language</h3>
<p>Logging in to the ftp, we find a text file named Eli&rsquo;s_Creds.txt. We download the file to our
local machin using get, and have a look at it.</p>
<p><img src="/img/tryhackme_yearoftherabbit/12.png" alt=""></p>
<p>Seems to be some sort of encoded text.
Searching on google, we find that the text is actually a progamming language
called <a href="https://en.wikipedia.org/wiki/Brainfuck">Brainfuck</a></p>
<p>We use this site : <a href="http://bf.doleczek.pl/"></a> to interpret our code. Running
the code , we get :</p>
<p><img src="/img/tryhackme_yearoftherabbit/13.png" alt=""></p>
<p>Creds found:</p>
<blockquote>
<p>User: eli
Password: DSpDiM1wAEwid</p>
</blockquote>
<p>We use the password to login to ssh as user eli and succeed.</p>
<p><img src="/img/tryhackme_yearoftherabbit/14.png" alt=""></p>
<p>In the /home directory, we find another user &ldquo;gwendoline&rdquo;, whose home directory
contains the &ldquo;user.txt&rdquo; file. So we have to escalate our privileges to user
gwendoline.</p>
<h2 id="privilege-escalation--user-gwandoline">Privilege Escalation : User-gwandoline</h2>
<p>Checking a bit, we see that on ssh login of eli, we get a message from root to user
gwendoline</p>
<p><img src="/img/tryhackme_yearoftherabbit/15.png" alt=""></p>
<p>We try to locate the &ldquo;s3cr3t&rdquo; location and find it in /usr/games. We cat out
the file and get the password for the user gwendolne</p>
<p><img src="/img/tryhackme_yearoftherabbit/16.png" alt=""></p>
<p>Creds found :</p>
<blockquote>
<p>gwendoline : MniVCQVhQHUNI</p>
</blockquote>
<p>Now we su to user gwendoline and read out the user.txt file</p>
<p><img src="/img/tryhackme_yearoftherabbit/17.png" alt=""></p>
<h2 id="privilege-escalation--root">Privilege Escalation : Root</h2>
<p>Running <code>sudo -l</code> shows us</p>
<p><img src="/img/tryhackme_yearoftherabbit/18.png" alt=""></p>
<p>So, we can run <code>sudo /usr/bin/vi /home/gwendoline/user.txt</code> as ALL users
but not root. This <code>(ALL, !root)</code> sudo permission is a known sudo
vulnerability with <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-14287">CVE-2019-14287</a>. The exploit is found <a href="https://www.exploit-db.com/exploits/47502">here</a>.</p>
<p>So we run the  following command:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt
</code></pre></div><p>And we get our vim editor running as root. Now to get a root shell, we go over
to <a href="https://gtfobins.github.io/gtfobins/vim/#shell">gtfobins</a> and follow the
instructions to get a root shell and read our flag from root.txt file.</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vim" data-lang="vim"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>vim<span style="color:#a61717;background-color:#e3d2d2">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#a61717;background-color:#e3d2d2"></span>:set shell=<span style="color:#ed9d13">/bin/</span>sh<span style="color:#a61717;background-color:#e3d2d2">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span><span style="color:#a61717;background-color:#e3d2d2"></span>:shell<span style="color:#a61717;background-color:#e3d2d2">
</span></code></pre></div><p><img src="/img/tryhackme_yearoftherabbit/19.png" alt=""></p>
<h3 id="extra-findings">Extra findings</h3>
<p>suid3num.py found us some interesting SUID files:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>[~] Custom SUID Binaries (Interesting Stuff)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span>------------------------------
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span>/usr/bin/X
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span>/usr/bin/procmail
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span>/usr/lib/spice-gtk/spice-client-glib-usb-acl-helper
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span>/usr/lib/pt_chown
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7</span>------------------------------
</code></pre></div><p>Looking for suid files, we got:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#999;font-style:italic"># find / -perm -u=s -type f 2&gt;/dev/null</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>/bin/mount
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>/bin/umount
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>/bin/su
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>/bin/fusermount
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>/bin/ntfs-3g
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>/usr/bin/vmware-user-suid-wrapper
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>/usr/bin/X
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>/usr/bin/procmail
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>/usr/bin/pkexec
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>/usr/bin/gpasswd
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>/usr/bin/newgrp
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>/usr/bin/sudo
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>/usr/bin/chsh
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>/usr/bin/chfn
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>/usr/bin/at
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>/usr/sbin/exim4
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>/usr/sbin/pppd
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>/usr/lib/policykit-1/polkit-agent-helper-1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span>/usr/lib/spice-gtk/spice-client-glib-usb-acl-helper
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span>/usr/lib/openssh/ssh-keysign
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>/usr/lib/pt_chown
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span>/usr/lib/eject/dmcrypt-get-device
</code></pre></div><ul>
<li>
<p>We find a vulnerability for pt_chown which allowd privesc to root <a href="ihttps://www.exploit-db.com/exploits/19467">here</a>
pt_chown is a program included with glibc 2.1.x that exists to aid the proper
allocation of terminals for non-suid programs that don&rsquo;t have devpts support.
It is installed setuid root.
We download the exploit to our local machine and transfer it to our target.
Compiling the exploit with gcc, we run it with /dev/ptyxx as arg. But get
a permission denied.</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>gcc exploit.c -o exploit
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span>./exploit /dev/pty12
</code></pre></div></li>
<li>
<p>Exim is vunerable as well. It is a mail server. We find it running on a port
internally on the target. We can connect to it using nc. There is an rce
<a href="https://nvd.nist.gov/vuln/detail/CVE-2019-10149">here</a> but we failed to
exploit it.</p>
</li>
</ul>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>Permalink: </strong>
      <a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-year-of-the-rabbit-writeup/" title="TryHackMe - Year of the Rabbit - Writeup" target="_blank" rel="external">https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-year-of-the-rabbit-writeup/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License：</strong><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/fmash16" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://fmash16.github.io/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/fmash16" target="_blank"><span class="text-dark">fmash16</span></a></h3>
        <div>Hack the Planet</div>
      </div>
    </figure>
  </div>
</div>

    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-ultratech-writeup/" title="TryHackMe - UltraTech Writeup"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-montevarde-writeup/"
                    title="Hackthebox - Montevarde Writeup"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="Catalogue" role="button">
                    <span>[&nbsp;</span><span>Index</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="facebook,twitter"
                data-mobile-sites="">Share on:</div>
        </div>
    </div>
</nav>



</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/fmash16" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://fmash16.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
    <li><a href="https://twitter.com/fmash16" target="_blank" title="twitter" data-toggle=tooltip data-placement=top >
            <i class="icon icon-twitter"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2020  -
    2020
    
    
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"></script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://fmash16.github.io/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://fmash16.github.io/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
            },
            ROOT_URL: 'https:\/\/fmash16.github.io\/',
            CONTENT_URL: 'https:\/\/fmash16.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://fmash16.github.io/js/insight.min.7f3407251ef14950645ac695d0cf7cd29c5cabfb6916e63dcb54b83d8f1fc2126d10bd5446875e78d27a76ecd651a3532b49a7e4da02ee4de51660edba2d23f1.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>


/* copy code button */
<script>
function addCopyButtons(clipboard) {
    document.querySelectorAll('pre > code').forEach(function (codeBlock) {
        var button = document.createElement('button');
        button.className = 'copy-code-button';
        button.type = 'button';
        button.innerText = 'Copy';

        button.addEventListener('click', function () {
              
            tmp = codeBlock.innerText.split("\n");
            cutChar = (tmp.length>8) ? 2 : 1;
            for(i=0; i<tmp.length; i++){
              tmp[i] = tmp[i].substring(cutChar);
            }
            block = tmp.join("\n");
            clipboard.writeText(block).then(function () {
                

                button.blur();

                button.innerText = 'Copied!';

                setTimeout(function () {
                    button.innerText = 'Copy';
                }, 2000);
            }, function (error) {
                button.innerText = 'Error';
            });
        });

        var pre = codeBlock.parentNode;
        if (pre.parentNode.classList.contains('highlight')) {
            var highlight = pre.parentNode;
            highlight.parentNode.insertBefore(button, highlight);
        } else {
            pre.parentNode.insertBefore(button, pre);
        }
    });
}
if (navigator && navigator.clipboard) {
    addCopyButtons(navigator.clipboard);
} else {
    var script = document.createElement('script');
    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js';
    script.integrity = 'sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=';
    script.crossOrigin = 'anonymous';
    script.onload = function() {
        addCopyButtons(clipboard);
    };

    document.body.appendChild(script);
}

</script>



  </body>
</html>
